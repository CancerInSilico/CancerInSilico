---
title: "Simulating Gene Expression"
author: "Thomas D. Sherman, Raymond Cheng, Elana J. Fertig"
date: "`r doc_date()`"
package: "`r pkg_ver('CancerInSilico')`"
bibliography: References.bib
vignette: >
  %\VignetteIndexEntry{The CancerInSilico Package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
output: 
  BiocStyle::html_document
---

```{r include=FALSE, cache=FALSE}
library(CancerInSilico)
pathways = list()
pathways[["GTOMPATHWAY"]] = c("g1","g2","g3","g4","g5","g6","g7","g8","g9","g10","g11")
pathways[["GTOSPATHWAY"]] = c("g1","g2","g3","g4","g5","g6","g7")
pathways[["PROXPATHWAY"]] = c("g1","g2","g3","g4","g5","g6","g7","g8","g9")
data <- runCancerSim(1,24,recordIncrement = 1)

```
```{r set-options, echo = FALSE}
options(width = 3000)

```

# Introduction

The main objective of the gene expression methods is to be able to simulate the amount of genes expressed in a pathway during certain situations. For the most part, functions are divided into two types of functions with a certain specification in the function name: "group" specifies the function taking the averages of the genes expressed in the cells, and "sing" specifying the function takes the average gene expressed for each cell at the time. All these calculations are based off the model created using *runCancerSim* and either a list or vector of the pathways used in each of the pathway or scenario.


# *simulateGeneExpGroup* and *simulateGeneExpSing*

Within this part of the package, two main functions can be used in order to develop the general gene distributions based on the information wanted. These functions take all the models and merge them together by taking the maximum of each gene expressed.

## *simulateGeneExpGroup*: Main Function for Gene Expression Averages

The *simulateGeneExpGroup* function provides a centralized function to generate all three models of the pathways simulated, specifically for the simulations that determine average gene expression presented by the model at each time. It also creates a noise model based on the option selected, which is added to the simulation data to simulate real-life data collection. The following code provides an example of a run of *simulateGeneExpGroup* to simulate the average gene expression with a normal distribution noise model at each hour.

```{r}
average_genes_expressed = simulateGeneExpGroup(data, pathways, perError = 0.01, opt = 1)

```
```{r , echo = FALSE}
average_genes_expressed[,1:5]

```

*Figure 1* a matrix object containing the average number of genes, to the length of the model's duration.

### *simulateGeneExpGroup* Function Signature

```{r,eval=FALSE}
simulateGeneExpGroup(model,pathway,perError = 0.1,opt = 1,success = 1)
```

### Output of *simulateGeneExpGroup*

The output of *simulateGeneExpGroup* is stored into a matrix object that compares the average of each gene to each individual hour of the model. This object behaves like a normal matrix object in "R", where each individual element of the represents the maximum amount of the gene expressed within all the pathways. Some or no overlap may occur for some of the genes as not each pathway is required to have similar genes.


## *simulateGeneExpSing*: Main Function for Gene Expression Per Cell

The *simulateGeneExpSing* function provides a centralized function to generate all three models of the pathways simulated, specfically for the simulations running to determine gene expression for each individual cell. It also creates a noise model based on the option selected, which is added to the simulation data to simulate real-life data collection. The following code provides an example of a run of *simulateGeneExpSing* to simulate the average gene expression with a negative binomial distribution noise model at each hour.

```{r}
genes_per_cell_expressed = simulateGeneExpSing(data, pathways, opt = 2, success = 5)

```
```{r,echo = FALSE,collapse=TRUE}
genes_per_cell_expressed[1:2]

```
*Figure 2* a matrix object containing the average number of genes, to the length of the model's duration.

### *simulateGeneExpsing* Function Signature

```{r,eval=FALSE}
simulateGeneExpSing(model,pathway,perError = 0.1,opt = 1,success = 1)
```

### Output of *simulateGeneExpSing*

The output of *simulateGeneExpGroup* is stored into a list object. Each individual element of the list contains a matrix comparing the genes for all the pathways to the cell. The behavior of the object is similar to that of a list, however each individual element of the list is a matrix so syntax used with a matrix can be applied as well. Specifying a certain element in the list is returning a matrix at the specified (model) hour. Specifying an element in the matrix returns the maximum genes expressed by the specified cell.


## Parameters

Both functions, *simulateGeneExpSing* and *simulateGeneExpGroup* have the same parameter with similar results being generated upon running these functions. However they end in a list and matrix respectively.

### Parameter Overview

* *model* - [CellModel] Required Parameter; Generated from *runCancerSim*  
* *pathway* - [List] Required Parameter; Must be a list of 3  
* *perError* - [Double] Optional Parameter; Should be less than 1  
* *opt* - [Integer] Optional Parameter; Varies from 1 to 3  
* *success* - [Double] Optional Parameter; Greater than or equal to 1  

### Parameter Description

*model*

A *CellModel* object generated from *runCancerSim*. Basic requirement for both *simulateGeneExpSing*, and *simulateGeneExpGroup*

*pathway*

A list of gene pathways needed to be provided by the user in order to generate simulated gene expression data. The *pathway* parameters requires a few things in order for the function to work: 1) Each element of the list is required to be a vector of the genes expressed in each pathway; 2) The order of the pathways from first to last are as follows: G<sub>2</sub> to M, G<sub>1</sub> to S, and Contact Inhibition Pathway.

*perError*

The amount possible error that can be generated using the data from the model. This normally is a value below 1, with a default of 0.1.

*opt*

The option parameter that allows the user to decide on the output's noise model.

*success*

The number of success, "k", that is used to calculate the negative binomial model's, <b>&phi;</b> and <b>&mu;</b> parameters.

## Other Functions



